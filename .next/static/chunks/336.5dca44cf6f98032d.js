"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[336],{3336:function(t,e,a){a.d(e,{offchainLookup:function(){return N},offchainLookupSignature:function(){return R}});var n=a(1693),r=a(2791),s=a(1273),o=a(7307);class c extends s.G{constructor({callbackSelector:t,cause:e,data:a,extraData:n,sender:r,urls:s}){var c;super(e.shortMessage||"An error occurred while fetching for an offchain result.",{cause:e,metaMessages:[...e.metaMessages||[],(null===(c=e.metaMessages)||void 0===c?void 0:c.length)?"":[],"Offchain Gateway Call:",s&&["  Gateway URL(s):",...s.map(t=>"    ".concat((0,o.G)(t)))],"  Sender: ".concat(r),"  Data: ".concat(a),"  Callback selector: ".concat(t),"  Extra data: ".concat(n)].flat(),name:"OffchainLookupError"})}}class i extends s.G{constructor({result:t,url:e}){super("Offchain gateway response is malformed. Response data must be a hex value.",{metaMessages:["Gateway URL: ".concat((0,o.G)(e)),"Response: ".concat((0,r.P)(t))],name:"OffchainLookupResponseMalformedError"})}}class u extends s.G{constructor({sender:t,to:e}){super("Reverted sender address does not match target contract address (`to`).",{metaMessages:["Contract address: ".concat(e),"OffchainLookup sender address: ".concat(t)],name:"OffchainLookupSenderMismatchError"})}}var d=a(7825),l=a(8890),f=a(4247),h=a(4898),p=a(4433),w=a(9318),m=a(1230),y=a(35),g=a(6390),b=a(5581),v=a(3090),E=a(9226),k=a(8201),M=a(7705),L=a(2261);let x="/docs/contract/encodeErrorResult";function C(t){let{abi:e,errorName:a,args:n}=t,r=e[0];if(a){let t=(0,L.mE)({abi:e,args:n,name:a});if(!t)throw new b.MS(a,{docsPath:x});r=t}if("error"!==r.type)throw new b.MS(void 0,{docsPath:x});let s=(0,M.t)(r),o=(0,E.C)(s),c="0x";if(n&&n.length>0){if(!r.inputs)throw new b.Zh(r.name,{docsPath:x});c=(0,f.E)(r.inputs,n)}return(0,w.SM)([o,c])}let P="/docs/contract/encodeFunctionResult",G="x-batch-gateway:true";async function O(t){let{data:e,ccipRequest:a}=t,{args:[n]}=function(t){let{abi:e,data:a}=t,n=(0,v.tP)(a,0,4),r=e.find(t=>"function"===t.type&&n===(0,E.C)((0,M.t)(t)));if(!r)throw new b.eF(n,{docsPath:"/docs/contract/decodeFunctionData"});return{functionName:r.name,args:"inputs"in r&&r.inputs&&r.inputs.length>0?(0,k.r)(r.inputs,(0,v.tP)(a,4)):void 0}}({abi:y.Yi,data:e}),r=[],s=[];return await Promise.all(n.map(async(t,e)=>{try{s[e]=t.urls.includes(G)?await O({data:t.data,ccipRequest:a}):await a(t),r[e]=!1}catch(t){r[e]=!0,s[e]="HttpRequestError"===t.name&&t.status?C({abi:y.Yi,errorName:"HttpError",args:[t.status,t.shortMessage]}):C({abi:[g.Up],errorName:"Error",args:["shortMessage"in t?t.shortMessage:t.message]})}})),function(t){let{abi:e,functionName:a,result:n}=t,r=e[0];if(a){let t=(0,L.mE)({abi:e,name:a});if(!t)throw new b.xL(a,{docsPath:P});r=t}if("function"!==r.type)throw new b.xL(void 0,{docsPath:P});if(!r.outputs)throw new b.MX(r.name,{docsPath:P});let s=(()=>{if(0===r.outputs.length)return[];if(1===r.outputs.length)return[n];if(Array.isArray(n))return n;throw new b.hn(n)})();return(0,f.E)(r.outputs,s)}({abi:y.Yi,functionName:"query",result:[r,s]})}let R="0x556f1830",S={name:"OffchainLookup",type:"error",inputs:[{name:"sender",type:"address"},{name:"urls",type:"string[]"},{name:"callData",type:"bytes"},{name:"callbackFunction",type:"bytes4"},{name:"extraData",type:"bytes"}]};async function N(t,e){let{blockNumber:a,blockTag:r,data:s,to:o}=e,{args:i}=(0,l.p)({data:s,abi:[S]}),[d,m,y,g,b]=i,{ccipRead:v}=t,E=v&&"function"==typeof(null==v?void 0:v.request)?v.request:T;try{if(!function(t,e){if(!(0,p.U)(t,{strict:!1}))throw new h.b({address:t});if(!(0,p.U)(e,{strict:!1}))throw new h.b({address:e});return t.toLowerCase()===e.toLowerCase()}(o,d))throw new u({sender:d,to:o});let e=m.includes(G)?await O({data:y,ccipRequest:E}):await E({data:y,sender:d,urls:m}),{data:s}=await (0,n.R)(t,{blockNumber:a,blockTag:r,data:(0,w.zo)([g,(0,f.E)([{type:"bytes"},{type:"bytes"}],[e,b])]),to:o});return s}catch(t){throw new c({callbackSelector:g,cause:t,data:s,extraData:b,sender:d,urls:m})}}async function T(t){let{data:e,sender:a,urls:n}=t,s=Error("An unknown error occurred.");for(let t=0;t<n.length;t++){let c=n[t],u=c.includes("{data}")?"GET":"POST",l="POST"===u?{data:e,sender:a}:void 0,f="POST"===u?{"Content-Type":"application/json"}:{};try{var o;let t;let n=await fetch(c.replace("{sender}",a.toLowerCase()).replace("{data}",e),{body:JSON.stringify(l),headers:f,method:u});if(t=(null===(o=n.headers.get("Content-Type"))||void 0===o?void 0:o.startsWith("application/json"))?(await n.json()).data:await n.text(),!n.ok){s=new d.Gg({body:l,details:(null==t?void 0:t.error)?(0,r.P)(t.error):n.statusText,headers:n.headers,status:n.status,url:c});continue}if(!(0,m.v)(t)){s=new i({result:t,url:c});continue}return t}catch(t){s=new d.Gg({body:l,details:t.message,url:c})}}throw s}}}]);